# Incident Report — Firewall Hardening, Nmap Reconnaissance & Wireshark Verification

- **Author:** Gene Crittenden
- **Date:** 2025-11-14
- **Environment:** VirtualBox Host-Only SOC Lab
- **Incident Category:** Reconnaissance Activity / Firewall Validation
- **Systems Involved:**
  - Web Server — 192.168.56.101
  - Client / Scanner — 192.168.56.102

---

## Summary

This exercise simulated external reconnaissance attempts against the web server (192.168.56.101) to validate a newly configured firewall.
Nmap scanning was performed from the client VM (192.168.56.102), while Wireshark captured traffic on the web server to verify whether the firewall correctly:

- Allowed legitimate services
- Dropped unauthorized traffic silently
- Rejected traffic on restricted ports (with ICMP/TCP feedback)

The results showed that **UFW behaves exactly as configured**, and no malicious activity or compromise occurred.
This was a controlled SOC training activity.

---

## Timeline of Events

| Time | Event |
|------|-------|
| T+0m | Baseline Nmap scan performed from 192.168.56.102 |
| T+5m | Firewall rules applied on 192.168.56.101 |
| T+7m | Second Nmap scan performed to evaluate firewall behavior |
| T+10m | Wireshark capture started on web server |
| T+12m | Targeted scans executed (port 443, full port sweep) |
| T+15m | Wireshark capture stopped and analyzed |
| T+20m | Findings recorded and supporting evidence exported |

---

## Firewall Configuration at Time of Incident

```bash
sudo ufw default deny incoming
sudo ufw allow 80/tcp
sudo ufw allow 22/tcp # optional
sudo ufw deny 443
sudo ufw reject 443
sudo ufw enable
````
**Expected Behaviours**
- Port 80 -> allowed
- Port 22 -> allowed
- Port 443 -> explicitly reject
- All other ports -> silently dropped

---

# Supporting Files

| File | Description |
|------|------------|
| baseline.txt | Text file of packet capture pre firewall rules |
| firewall_blocking.txt  | Text file of packet capture after firewall rules set and client performs scans |
| wireshark_filters_1.png | Screenshot of wireshark filters used |
| wireshark_filters_2.png | Screenshot of wireshark filters used |
| wireshark_filters_3.png | Screenshot of wireshark filters used |
| wireshark_filters_4.png | Screenshot of wireshark filters used |
| wireshark_filters_5.png | Screenshot of wireshark filters used |
| nmap_scan_1.png | Screenshot of Nmap scans from Client |
| nmap_scan_2.png | Screenshot of Nmap scans from Client |
| README.md | Markdown file outlining the exercise and it's parameters/goals |
| grc_report.md | GRC report regarding the exercise |

---

# SOC Analysis
1. Allowed traffic - Port 80 (nginx)
- Nmap output:
  - 80/tcp open http

Wireshark Observations:
- SYN -> SYN/ACK -> ACK (TCP) Handshake
- Normal HTTP connection behaviour
- No anomalies observed

This shows the firewall is correctly permitting legitimate service traffic.

2. Dropped Traffic - Default deny behaviour
- Nmap output:
  - 21/tcp filtered ftp

Wireshark Observations
- SYN packets from 192.168.56.102
- No response from 192.168.56.101
- Multiple SYN retransmissions
- No ICMP errors

This confirms silent drop behaviour consistent with ufw default deny incoming.

3. Rejected Traffic - Port 443
- Port 443 was configured with both deny and reject
- Nmap output:
  - 443/tcp closed/filtered https

Wireshark Observations
- TCP RST packets

This demonstrates the firwall is explicitly rejecting connection attempts on port 443.

--- 

# Packet Capture Evidence

The following filters were used to to analyse the traffic:
1. Show normal allowed nginx traffic
- tcp.port == 80
2. Show SYN packets and silent drops
- tcp.flags.syn == 1 && ip.src == 192.168.56.102
3. Display ICMPv6 admin-prohibited responses for REJECT rules
- icmpv6
4. Show TCP resets generated by UFW on rejected ports.
- tcp.flags.reset == 1

All artifacts were uploads as .txt - the original .pcapng files are available on request.

---

# Impact Assesment

- No compromise occured; all activity was intentional
- Firewall responses matched the configured security policy
- Unauthorized port access was correctly prevented or rejected
- The attack surface is minimal and properly controlled

---

# Root Cause

No malicious cause - this was a planned validation test. Observed behaviour was normal and expected.

# Recommendations

- Maintain explicit allow/deny lists in UFW
- Continue capturing evidence for each configuration change.
- Forward UFW logs to a SIEM for correlation
- Add suricata or Zeek to detect port scanning attempts.
- Implement host-based logging (systemd journal forwarding)

---

# Conclusion

The web server firewall is functioning properly:
- Allowed ports respond as expected
- Silent drops occur on unspecified ports
- Port 443 returns ICMP or TCP rejecting packets
- Nmap and Wireshark output matches expected firewall behaviour

This exercise successfully demonstrates how a SOC analyst validates network controls using reconnaissance traffic and packet capture evidence using real packet captures.

End of Report
